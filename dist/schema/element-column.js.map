{"version":3,"sources":["../../src/schema/element-column.js"],"names":["ElementColumn","element","rawColumn","type","id","part","index","_type","_element","_rawColumn","_id","key","_part","_index","valueFrom","feature","isStatusElement","statusValue","recordStatus","formValues","get","exportValue","options","value","format","label","name","dataName","isPhotoElement","isVideoElement","isAudioElement","isSignatureElement","isRepeatableElement","isNumber","isDate"],"mappings":"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","file":"element-column.js","sourcesContent":["import Column from './column';\nimport { StatusValue, Record } from 'fulcrum-core';\n\nexport default class ElementColumn extends Column {\n  constructor({element, rawColumn, type, id, part, index}) {\n    super();\n\n    this._type = type;\n    this._element = element;\n    this._rawColumn = rawColumn;\n    this._id = id || element.key;\n    this._part = part;\n    this._index = index;\n\n    if (part) {\n      this._id += '_' + part;\n    }\n  }\n\n  get type() {\n    return this._type;\n  }\n\n  get name() {\n    if (this.part) {\n      return this.element.label + ' (' + this.part + ')';\n    }\n\n    return this.element.label;\n  }\n\n  get element() {\n    return this._element;\n  }\n\n  get rawColumn() {\n    return this._rawColumn;\n  }\n\n  get columnName() {\n    if (this.rawColumn) {\n      return this.rawColumn.name;\n    }\n\n    if (this.part) {\n      return this.element.dataName + '_' + this.part;\n    }\n\n    return this.element.dataName;\n  }\n\n  get id() {\n    return this._id;\n  }\n\n  get part() {\n    return this._part;\n  }\n\n  valueFrom(feature) {\n    if (this.element.isStatusElement) {\n      if (feature instanceof Record) {\n        return feature.statusValue;\n      }\n\n      return new StatusValue(this.element, feature.recordStatus);\n    }\n\n    return feature.formValues.get(this.element.key);\n  }\n\n  exportValue(feature, options) {\n    const value = this.valueFrom(feature);\n\n    if (value) {\n      return value.format({feature, part: this.part, ...options});\n    }\n\n    return null;\n  }\n\n  get canSearch() {\n    if (this.element.isPhotoElement ||\n        this.element.isVideoElement ||\n        this.element.isAudioElement ||\n        this.element.isSignatureElement ||\n        this.element.isRepeatableElement) {\n      return false;\n    }\n\n    return true;\n  }\n\n  get supportsRanges() {\n    // Repeatable columns are an exception, they don't support ranges yet because we don't\n    // have a physical column to query.\n    if (this.element.isRepeatableElement) {\n      return false;\n    }\n\n    return this.isNumber || this.isDate;\n  }\n\n  get isSortable() {\n    if (this.element.isPhotoElement ||\n        this.element.isVideoElement ||\n        this.element.isAudioElement ||\n        this.element.isSignatureElement ||\n        this.element.isRepeatableElement) {\n      return false;\n    }\n\n    return true;\n  }\n}\n"]}